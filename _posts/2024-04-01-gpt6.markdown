---
layout: post
title: 大模型，小探索 —— 在 16G 的 AMD 上搞微调有多作死？（出坑篇）
toc:  true
author: 小狗屁
tags: [GPT-Explore]
css:
  - "assets/markdown.css"
---

微信公众号内容地址: 

> 微调实操: 数据集、超参数、模型结构，和评测指标。

总的来说，本次实操的思路如下：

1. **数据**阶段: 选定业务场景，找寻数据集。
2. **爬坡**阶段: 选定模型、固定基本训练超参数，**增加数据量**，达到初步效果。
3. **调参**阶段: 选定模型**评测指标**，固定数据，A/B Test 调优**超参数**。
4. **对比**阶段: 选定模型评测指标，固定数据、超参数，对比**不同模型**。

# 数据阶段

来源: https://tianchi.aliyun.com/competition/entrance/531904/information

![](https://files.mdnice.com/user/44560/fbeacf2f-dec4-41fc-b39a-46b463a20387.png)

初步预览如下，一共 5000 条数据:

![](https://files.mdnice.com/user/44560/1250e6ca-6f12-4c21-85d0-2fff573312dc.png)

用户问题和答案列自然形成了 Q&A 的形式，无需进行过多转换处理；同时，官方网站的数据集，也减少了**数据清洗**、检验**标注质量**等操作的负担；更为重要的还是，**便于验证**:

- 其一，模型本身应该之前没有学习过类似知识。
- 其二，难度适中，相比于生成型任务，该任务更接近于分类。
- 其三，答案客观，较好验证结果。

可以将其转化成 telecom_train_5000.json，

```
[
  {
    "instruction": "回答中国电信手机用户的问题,9元百度专属定向流量包如何取消,应该怎么做？",
    "input": "",
    "output": "取消方式_68"
  },
  {
    "instruction": "回答中国电信手机用户的问题,你告诉我7天5g视频会员流量包怎么开通，多少钱,应该怎么做？",
    "input": "",
    "output": "业务简介_111|9.9|11.9|开通方式_98|业务简介_109|开通方式_97"
  },
  ...
]
```

将数据更新到 LLaMA Factory 框架中，

```
vi LLM/LLaMA-Factory/data/dataset_info.json
''' 文件内容
  ...
"telecom_train_5000": {
    "file_name": "telecom_train_5000.json",
    "columns": {
      "prompt": "instruction",
      "query": "input",
      "response": "output"
    }
  },
'''
```

同样的操作，可以准备好 telecom_train_400、telecom_train_100、telecom_test_100 等数据集备用（截取数据时需要考虑**数据平衡**，即不同规模的数据集内，各类别的问题数量比例应尽量保持一致）。

